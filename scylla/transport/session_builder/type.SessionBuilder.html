<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `SessionBuilder` type in crate `scylla`."><title>SessionBuilder in scylla::transport::session_builder - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="scylla" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.0 (8ede3aae2 2023-07-12)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc type"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../scylla/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../scylla/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">SessionBuilder</a></h2><div class="sidebar-elems"><section><h3><a href="#implementations">Methods</a></h3><ul class="block"><li><a href="#method.address_translator">address_translator</a></li><li><a href="#method.authenticator_provider">authenticator_provider</a></li><li><a href="#method.known_node">known_node</a></li><li><a href="#method.known_node_addr">known_node_addr</a></li><li><a href="#method.known_nodes">known_nodes</a></li><li><a href="#method.known_nodes_addr">known_nodes_addr</a></li><li><a href="#method.new">new</a></li><li><a href="#method.user">user</a></li><li><a href="#method.write_coalescing">write_coalescing</a></li></ul><h3><a href="#trait-implementations">Trait Implementations</a></h3><ul class="block"><li><a href="#impl-Default-for-SessionBuilder">Default</a></li></ul></section><h2><a href="index.html">In scylla::transport::session_builder</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Type Definition <a href="../../index.html">scylla</a>::<wbr><a href="../index.html">transport</a>::<wbr><a href="index.html">session_builder</a>::<wbr><a class="type" href="#">SessionBuilder</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/scylla/transport/session_builder.rs.html#38">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub type SessionBuilder = <a class="struct" href="struct.GenericSessionBuilder.html" title="struct scylla::transport::session_builder::GenericSessionBuilder">GenericSessionBuilder</a>&lt;<a class="enum" href="enum.DefaultMode.html" title="enum scylla::transport::session_builder::DefaultMode">DefaultMode</a>&gt;;</code></pre><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor">§</a></h2><div id="implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-SessionBuilder" class="impl"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#72-331">source</a><a href="#impl-SessionBuilder" class="anchor">§</a><h3 class="code-header">impl <a class="type" href="type.SessionBuilder.html" title="type scylla::transport::session_builder::SessionBuilder">SessionBuilder</a></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.new" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#77-82">source</a><h4 class="code-header">pub fn <a href="#method.new" class="fn">new</a>() -&gt; Self</h4></section></summary><div class="docblock"><p>Creates new SessionBuilder with default configuration</p>
<h5 id="default-configuration"><a href="#default-configuration">Default configuration</a></h5>
<ul>
<li>Compression: None</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="method.known_node" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#101-104">source</a><h4 class="code-header">pub fn <a href="#method.known_node" class="fn">known_node</a>(self, hostname: impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/convert/trait.AsRef.html" title="trait core::convert::AsRef">AsRef</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.0/std/primitive.str.html">str</a>&gt;) -&gt; Self</h4></section></summary><div class="docblock"><p>Add a known node with a hostname</p>
<h5 id="examples"><a href="#examples">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>session: Session = SessionBuilder::new().known_node(<span class="string">&quot;127.0.0.1:9042&quot;</span>).build().<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>session: Session = SessionBuilder::new().known_node(<span class="string">&quot;db1.example.com&quot;</span>).build().<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.known_node_addr" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#119-122">source</a><h4 class="code-header">pub fn <a href="#method.known_node_addr" class="fn">known_node_addr</a>(self, node_addr: <a class="enum" href="https://doc.rust-lang.org/1.71.0/core/net/socket_addr/enum.SocketAddr.html" title="enum core::net::socket_addr::SocketAddr">SocketAddr</a>) -&gt; Self</h4></section></summary><div class="docblock"><p>Add a known node with an IP address</p>
<h5 id="example"><a href="#example">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_node_addr(SocketAddr::new(IpAddr::V4(Ipv4Addr::new(<span class="number">127</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)), <span class="number">9042</span>))
    .build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.known_nodes" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#136-139">source</a><h4 class="code-header">pub fn <a href="#method.known_nodes" class="fn">known_nodes</a>(
    self,
    hostnames: impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/convert/trait.AsRef.html" title="trait core::convert::AsRef">AsRef</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.0/std/primitive.str.html">str</a>&gt;&gt;
) -&gt; Self</h4></section></summary><div class="docblock"><p>Add a list of known nodes with hostnames</p>
<h5 id="example-1"><a href="#example-1">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_nodes([<span class="string">&quot;127.0.0.1:9042&quot;</span>, <span class="string">&quot;db1.example.com&quot;</span>])
    .build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.known_nodes_addr" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#157-163">source</a><h4 class="code-header">pub fn <a href="#method.known_nodes_addr" class="fn">known_nodes_addr</a>(
    self,
    node_addrs: impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.71.0/core/net/socket_addr/enum.SocketAddr.html" title="enum core::net::socket_addr::SocketAddr">SocketAddr</a>&gt;&gt;
) -&gt; Self</h4></section></summary><div class="docblock"><p>Add a list of known nodes with IP addresses</p>
<h5 id="example-2"><a href="#example-2">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>addr1 = SocketAddr::new(IpAddr::V4(Ipv4Addr::new(<span class="number">172</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">3</span>)), <span class="number">9042</span>);
<span class="kw">let </span>addr2 = SocketAddr::new(IpAddr::V4(Ipv4Addr::new(<span class="number">172</span>, <span class="number">17</span>, <span class="number">0</span>, <span class="number">4</span>)), <span class="number">9042</span>);

<span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_nodes_addr([addr1, addr2])
    .build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.user" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#182-188">source</a><h4 class="code-header">pub fn <a href="#method.user" class="fn">user</a>(
    self,
    username: impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.71.0/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>&gt;,
    passwd: impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.71.0/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>&gt;
) -&gt; Self</h4></section></summary><div class="docblock"><p>Set username and password for plain text authentication.<br />
If the database server will require authentication</p>
<h5 id="example-3"><a href="#example-3">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_node(<span class="string">&quot;127.0.0.1:9042&quot;</span>)
    .use_keyspace(<span class="string">&quot;my_keyspace_name&quot;</span>, <span class="bool-val">false</span>)
    .user(<span class="string">&quot;cassandra&quot;</span>, <span class="string">&quot;cassandra&quot;</span>)
    .build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.authenticator_provider" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#234-240">source</a><h4 class="code-header">pub fn <a href="#method.authenticator_provider" class="fn">authenticator_provider</a>(
    self,
    authenticator_provider: <a class="struct" href="https://doc.rust-lang.org/1.71.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;dyn <a class="trait" href="../../authentication/trait.AuthenticatorProvider.html" title="trait scylla::authentication::AuthenticatorProvider">AuthenticatorProvider</a>&gt;
) -&gt; Self</h4></section></summary><div class="docblock"><p>Set custom authenticator provider to create an authenticator instance during a session creation.</p>
<h5 id="example-4"><a href="#example-4">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>bytes::Bytes;
<span class="kw">use </span>scylla::{Session, SessionBuilder};
<span class="kw">use </span>async_trait::async_trait;
<span class="kw">use </span>scylla::authentication::{AuthenticatorProvider, AuthenticatorSession, AuthError};

<span class="kw">struct </span>CustomAuthenticator;

<span class="attr">#[async_trait]
</span><span class="kw">impl </span>AuthenticatorSession <span class="kw">for </span>CustomAuthenticator {
    <span class="kw">async fn </span>evaluate_challenge(<span class="kw-2">&amp;mut </span><span class="self">self</span>, token: <span class="prelude-ty">Option</span>&lt;<span class="kw-2">&amp;</span>[u8]&gt;) -&gt; <span class="prelude-ty">Result</span>&lt;<span class="prelude-ty">Option</span>&lt;Vec&lt;u8&gt;&gt;, AuthError&gt; {
        <span class="prelude-val">Ok</span>(<span class="prelude-val">None</span>)
    }

    <span class="kw">async fn </span>success(<span class="kw-2">&amp;mut </span><span class="self">self</span>, token: <span class="prelude-ty">Option</span>&lt;<span class="kw-2">&amp;</span>[u8]&gt;) -&gt; <span class="prelude-ty">Result</span>&lt;(), AuthError&gt; {
        <span class="prelude-val">Ok</span>(())
    }
}

<span class="kw">struct </span>CustomAuthenticatorProvider;

<span class="attr">#[async_trait]
</span><span class="kw">impl </span>AuthenticatorProvider <span class="kw">for </span>CustomAuthenticatorProvider {
    <span class="kw">async fn </span>start_authentication_session(<span class="kw-2">&amp;</span><span class="self">self</span>, _authenticator_name: <span class="kw-2">&amp;</span>str) -&gt; <span class="prelude-ty">Result</span>&lt;(<span class="prelude-ty">Option</span>&lt;Vec&lt;u8&gt;&gt;, Box&lt;<span class="kw">dyn </span>AuthenticatorSession&gt;), AuthError&gt; {
        <span class="prelude-val">Ok</span>((<span class="prelude-val">None</span>, Box::new(CustomAuthenticator)))
    }
}

<span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_node(<span class="string">&quot;127.0.0.1:9042&quot;</span>)
    .use_keyspace(<span class="string">&quot;my_keyspace_name&quot;</span>, <span class="bool-val">false</span>)
    .user(<span class="string">&quot;cassandra&quot;</span>, <span class="string">&quot;cassandra&quot;</span>)
    .authenticator_provider(Arc::new(CustomAuthenticatorProvider))
    .build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.address_translator" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#296-299">source</a><h4 class="code-header">pub fn <a href="#method.address_translator" class="fn">address_translator</a>(self, translator: <a class="struct" href="https://doc.rust-lang.org/1.71.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;dyn <a class="trait" href="../session/trait.AddressTranslator.html" title="trait scylla::transport::session::AddressTranslator">AddressTranslator</a>&gt;) -&gt; Self</h4></section></summary><div class="docblock"><p>Uses a custom address translator for peer addresses retrieved from the cluster.
By default, no translation is performed.</p>
<h5 id="example-5"><a href="#example-5">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">struct </span>IdentityTranslator;

<span class="attr">#[async_trait]
</span><span class="kw">impl </span>AddressTranslator <span class="kw">for </span>IdentityTranslator {
    <span class="kw">async fn </span>translate_address(
        <span class="kw-2">&amp;</span><span class="self">self</span>,
        untranslated_peer: <span class="kw-2">&amp;</span>UntranslatedPeer
    ) -&gt; <span class="prelude-ty">Result</span>&lt;SocketAddr, TranslationError&gt; {
        <span class="prelude-val">Ok</span>(untranslated_peer.untranslated_address)
    }
}

<span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_node(<span class="string">&quot;127.0.0.1:9042&quot;</span>)
    .address_translator(Arc::new(IdentityTranslator))
    .build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
<h5 id="example-6"><a href="#example-6">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span><span class="kw-2">mut </span>translation_rules = HashMap::new();
<span class="kw">let </span>addr_before_translation = SocketAddr::from_str(<span class="string">&quot;192.168.0.42:19042&quot;</span>).unwrap();
<span class="kw">let </span>addr_after_translation = SocketAddr::from_str(<span class="string">&quot;157.123.12.42:23203&quot;</span>).unwrap();
translation_rules.insert(addr_before_translation, addr_after_translation);
<span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_node(<span class="string">&quot;127.0.0.1:9042&quot;</span>)
    .address_translator(Arc::new(translation_rules))
    .build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.write_coalescing" class="method"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#327-330">source</a><h4 class="code-header">pub fn <a href="#method.write_coalescing" class="fn">write_coalescing</a>(self, enable: <a class="primitive" href="https://doc.rust-lang.org/1.71.0/std/primitive.bool.html">bool</a>) -&gt; Self</h4></section></summary><div class="docblock"><p>If true, the driver will inject a small delay before flushing data
to the socket - by rescheduling the task that writes data to the socket.
This gives the task an opportunity to collect more write requests
and write them in a single syscall, increasing the efficiency.</p>
<p>However, this optimization may worsen latency if the rate of requests
issued by the application is low, but otherwise the application is
heavily loaded with other tasks on the same tokio executor.
Please do performance measurements before committing to disabling
this option.</p>
<p>This option is true by default.</p>
<h5 id="example-7"><a href="#example-7">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>session: Session = SessionBuilder::new()
    .known_node(<span class="string">&quot;127.0.0.1:9042&quot;</span>)
    .write_coalescing(<span class="bool-val">false</span>) <span class="comment">// Enabled by default
    </span>.build()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details></div></details></div><h2 id="trait-implementations" class="small-section-header">Trait Implementations<a href="#trait-implementations" class="anchor">§</a></h2><div id="trait-implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-Default-for-SessionBuilder" class="impl"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#834-838">source</a><a href="#impl-Default-for-SessionBuilder" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/default/trait.Default.html" title="trait core::default::Default">Default</a> for <a class="type" href="type.SessionBuilder.html" title="type scylla::transport::session_builder::SessionBuilder">SessionBuilder</a></h3></section></summary><div class="docblock"><p>Creates a <a href="type.SessionBuilder.html" title="type scylla::transport::session_builder::SessionBuilder"><code>SessionBuilder</code></a> with default configuration, same as <a href="struct.GenericSessionBuilder.html#method.new" title="associated function scylla::transport::session_builder::GenericSessionBuilder::new"><code>SessionBuilder::new</code></a></p>
</div><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.default" class="method trait-impl"><a class="srclink rightside" href="../../../src/scylla/transport/session_builder.rs.html#835-837">source</a><a href="#method.default" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.71.0/core/default/trait.Default.html#tymethod.default" class="fn">default</a>() -&gt; Self</h4></section></summary><div class='docblock'>Returns the “default value” for a type. <a href="https://doc.rust-lang.org/1.71.0/core/default/trait.Default.html#tymethod.default">Read more</a></div></details></div></details></div></section></div></main></body></html>