<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A `metrics`-compatible exporter that outputs metrics to clients over TCP."><meta name="keywords" content="rust, rustlang, rust-lang, metrics_exporter_tcp"><title>metrics_exporter_tcp - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../metrics_exporter_tcp/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../metrics_exporter_tcp/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate metrics_exporter_tcp</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.7.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">metrics_exporter_tcp</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/metrics_exporter_tcp/lib.rs.html#1-621">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A <a href="https://docs.rs/metrics"><code>metrics</code></a>-compatible exporter that outputs metrics to clients over TCP.</p>
<p>This exporter creates a TCP server, that when connected to, will stream individual metrics to
the client using a Protocol Buffers encoding.</p>
<h2 id="backpressure"><a href="#backpressure">Backpressure</a></h2>
<p>The exporter has configurable buffering, which allows users to trade off how many metrics they
want to be queued up at any given time.  This buffer limit applies both to incoming metrics, as
well as the individual buffers for each connected client.</p>
<p>By default, the buffer limit is set at 1024 metrics.  When the incoming buffer – metrics being
fed to the exported – is full, metrics will be dropped.  If a client’s buffer is full,
potentially due to slow network conditions or slow processing, then messages in the client’s
buffer will be dropped in FIFO order in order to allow the exporter to continue fanning out
metrics to clients.</p>
<p>If no buffer limit is set, then te exporter will ingest and enqueue as many metrics as possible,
potentially up until the point of memory exhaustion.  A buffer limit is advised for this reason,
even if it is many multiples of the default.</p>
<h2 id="encoding"><a href="#encoding">Encoding</a></h2>
<p>Metrics are encoded using Protocol Buffers.  The protocol file can be found in the repository at
<code>proto/event.proto</code>.</p>
<h2 id="usage"><a href="#usage">Usage</a></h2>
<p>The TCP exporter can be constructed by creating a <a href="struct.TcpBuilder.html" title="TcpBuilder"><code>TcpBuilder</code></a>, configuring it as needed, and
calling <a href="struct.TcpBuilder.html#method.install" title="TcpBuilder::install"><code>TcpBuilder::install</code></a> to both spawn the TCP server as well as install the exporter
globally.</p>
<p>If necessary, the recorder itself can be returned so that it can be composed separately, while
still installing the TCP server itself, by calling <a href="struct.TcpBuilder.html#method.build" title="TcpBuilder::build"><code>TcpBuilder::build</code></a>.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// Install the exporter directly:
</span><span class="kw">let </span>builder = TcpBuilder::new();
builder.install().expect(<span class="string">&quot;failed to install TCP exporter&quot;</span>);

<span class="comment">// Or install the TCP server and get the recorder:
</span><span class="kw">let </span>builder = TcpBuilder::new();
<span class="kw">let </span>recorder = builder.build().expect(<span class="string">&quot;failed to install TCP exporter&quot;</span>);</code></pre></div>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TcpBuilder.html" title="metrics_exporter_tcp::TcpBuilder struct">TcpBuilder</a></div><div class="item-right docblock-short">Builder for creating and installing a TCP recorder/exporter.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TcpRecorder.html" title="metrics_exporter_tcp::TcpRecorder struct">TcpRecorder</a></div><div class="item-right docblock-short">A TCP recorder.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="metrics_exporter_tcp::Error enum">Error</a></div><div class="item-right docblock-short">Errors that could occur while installing a TCP recorder/exporter.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="metrics_exporter_tcp" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.1 (90743e729 2023-01-10)" ></div></body></html>